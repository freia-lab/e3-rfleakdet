record (waveform, "$(PREFIX):RFdata-$(NODE)") {
  field(DESC,"Listen to all replies")
  field(DTYP, "stream")
  field(SCAN, "1 second")
  field(NELM, "10")
  field(FTVL, "SHORT")
  field(INP,"@rfleakdet.proto getRFdata($(NODE)) $(RFDET_PORT)")
  field (FLNK, "$(PREFIX):RFdata-$(NODE):FAN1")
}

# Extract data from the waveform

record (fanout, "$(PREFIX):RFdata-$(NODE):FAN1") {
  field(DESC,"Extract all read data")
  field(SCAN, "Passive")
  field(SELM, "All")
  field(LNK1,"$(PREFIX):RFdata-$(NODE):FAN2")
 }

record (fanout, "$(PREFIX):RFdata-$(NODE):FAN2") {
  field(DESC,"Extract all read data")
  field(SCAN, "Passive")
  field(SELM, "All")
  field(LNK1,"$(PREFIX):RFdata-$(NODE):RFPEAK1")
 }

record (subArray, "$(PREFIX):RFdata-$(NODE):RFPEAK1") {
   field (DESC, "Chan 0 of $(PREFIX):RFdata-$(NODE)")
   field (DTYP, "Soft Channel")
   field (SCAN, "Passive")
   field (INP, "$(PREFIX):RFdata-$(NODE)")
   field (FTVL, "SHORT")
   field (INDX, 0)
   field (LOPR, -30.0)
   field (HOPR, 40.0)
   field (PREC, 0)
   field (MALM, 9)
}
